version: "3.8"

include:
{% if 'dnsservers' in group_names %}
  - $DOCKERDIR/data/compose/adguard.yml
{% endif %}
{% if 'management' in group_names %}
  # TODO: [bitwarden] Find out why CPU is 149 %
  # This caused power consumption of the server to double.
  # TODO: [monitoring] Find a tool to monitor CPU and MEM usage on containers
  #- $DOCKERDIR/data/compose/bitwarden.yml
  - $DOCKERDIR/data/compose/alertmanager.yml
  - $DOCKERDIR/data/compose/cloudflare.yml
  - $DOCKERDIR/data/compose/grafana.yml
  - $DOCKERDIR/data/compose/nodeexporter.yml
  - $DOCKERDIR/data/compose/prometheus.yml
  - $DOCKERDIR/data/compose/uptime-kuma.yml
  - $DOCKERDIR/data/compose/unifi.yml
{% endif %}
{% if 'production' in group_names %}
  - $DOCKERDIR/data/compose/change-detection.yml
  - $DOCKERDIR/data/compose/code-server.yml
  - $DOCKERDIR/data/compose/drawio.yml
  - $DOCKERDIR/data/compose/excalidraw.yml
  - $DOCKERDIR/data/compose/nextcloud.yml
  - $DOCKERDIR/data/compose/openspeedtest.yml
  - $DOCKERDIR/data/compose/paperless-ngx.yml
  - $DOCKERDIR/data/compose/plex.yml
  - $DOCKERDIR/data/compose/samba.yml
{% endif %}
{% if 'webservers' in group_names %}
  - $DOCKERDIR/data/compose/authelia.yml
  - $DOCKERDIR/data/compose/cadvisor.yml
  - $DOCKERDIR/data/compose/dozzle.yml
  - $DOCKERDIR/data/compose/echo-server.yml
  - $DOCKERDIR/data/compose/homepage.yml
  - $DOCKERDIR/data/compose/influxdb.yml
  - $DOCKERDIR/data/compose/mailrise.yml
  #- $DOCKERDIR/data/compose/oauth.yml
  - $DOCKERDIR/data/compose/phpmyadmin.yml
  - $DOCKERDIR/data/compose/portainer.yml
  - $DOCKERDIR/data/compose/traefik-proxy.yml
{% endif %}
  #- $DOCKERDIR/data/compose/watchtower.yml

networks:
  default:
    driver: bridge
